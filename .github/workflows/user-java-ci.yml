# This workflow will build a package using Maven and then publish it to GitHub packages when a release is created
# For more information see: https://github.com/actions/setup-java/blob/main/docs/advanced-usage.md#apache-maven-with-a-settings-path

name: user-java Maven Package

env:
  MAVEN_HOME: apis/user-java

on:

  workflow_dispatch:

  pull_request:
    branches:
      - main
    paths:
      - 'apis/user-java/**'
      # - ${{ env.MAVEN_HOME }}/**


jobs:
  build:
    # env:
    #   MAVEN_HOME: apis/user-java

    runs-on: ubuntu-latest
    permissions:
      contents: read
      packages: write

    steps:
    - uses: actions/checkout@v2
    
    - name: Print the input name to STDOUT
      run: echo First Test

    # - name: Set up JDK 11
    #   uses: actions/setup-java@v2
    #   with:
    #     java-version: '11'
    #     distribution: 'adopt'
    #     server-id: github # Value of the distributionManagement/repository/id field of the pom.xml
    #     settings-path: ${{ github.workspace }} # location for the settings.xml file

    # - name: Build with Maven
    #   working-directory: ${{ env.MAVEN_HOME }}
    #   run: mvn clean install

    # - name: Test Maven
    #   working-directory: ${{ env.MAVEN_HOME }}
    #   run: mvn test
      
    - name: Step To cause error
      run:  exit 1

    - uses: nashmaniac/create-issue-action@v1.1
      name: Create Issue Action
      if: ${{ failure() }}
      with:
        title: Build Failed
        token: ${{secrets.GITHUB_TOKEN}}
        assignees: ${{github.actor}}
        labels: worflow-failed
        body: Workflow failed for commit ${{github.sha}}
